package com.hisun.LN;

import java.io.IOException;
import java.sql.SQLException;

import com.hisun.BP.BPCQCCY;
import com.hisun.BP.BPCSGSEQ;
import com.hisun.BP.BPRPARM;
import com.hisun.BP.BPRPARP;
import com.hisun.BP.BPRTRT;
import com.hisun.SC.SCCCALL;
import com.hisun.SC.SCCCLDT;
import com.hisun.SC.SCCEXCP;
import com.hisun.SC.SCCGBPA_BP_AREA;
import com.hisun.SC.SCCGCPT;
import com.hisun.SC.SCCGWA;
import com.hisun.SC.SCCMPAG;
import com.hisun.SC.SCCMSG;
import com.hisun.SC.SCCWOUT;

public class LNZFCPL {
    boolean pgmRtn = false;
    String PGM_SCSSCLDT = "SCSSCLDT";
    char K_CKPD_INQ = '0';
    LNZFCPL_WS_MSGID WS_MSGID = new LNZFCPL_WS_MSGID();
    char WS_REPY_MTH = ' ';
    LNZFCPL_WS_TEMP_VAR_1 WS_TEMP_VAR_1 = new LNZFCPL_WS_TEMP_VAR_1();
    int WS_CNT = 0;
    int WS_13MONTH_DT = 0;
    short WS_LFT_TO_CMP_TERM = 0;
    short WS_SPE_TERM = 0;
    short WS_NEW_TERM_NO = 0;
    short WS_TERM_NO = 0;
    short WS_TERM_CNT = 0;
    short WS_PHS_NO = 0;
    short WS_APRD_PERD = 0;
    char WS_APRD_PERD_UNIT = ' ';
    short WS_FACT_TERM = 0;
    short WS_LAST_CMP_TERM = 0;
    short WS_CMP_TERM = 0;
    short WS_PLPI_TERM = 0;
    double WS_SUM_REM_PRIN = 0;
    double WS_DUE_REPY_AMT = 0;
    double WS_PAIP_PAY_AMT_PRIN = 0;
    double WS_PAIP_PAY_AMT_INT = 0;
    double WS_SUM_PRIN = 0;
    double WS_CAL_BALLOON_BAL = 0;
    double WS_LN_BAL = 0;
    double WS_PAIP_CUR_INST_AMT = 0;
    double WS_CAL_BAL = 0;
    double WS_FULL_INT = 0;
    double WS_LN_BAL_INT = 0;
    double WS_PAIP_BAL = 0;
    double WS_PAIP_BAL_INT = 0;
    double WS_P_TOT_IPLN_AMT = 0;
    double WS_OS_IPLN_AMT = 0;
    double WS_REPY_AMT = 0;
    double WS_ORIGN_REPY_AMT = 0;
    double WS_LAST_TERM_AMT = 0;
    double WS_LOW_CCY_INT_AMT = 0;
    double WS_LOW_CCY_INT_AMT1 = 0;
    double WS_LOW_CCY_INT_AMT2 = 0;
    double WS_HIGH_AMT1 = 0;
    short WS_PAY_PERD = 0;
    char WS_PAY_UNIT = ' ';
    int WS_CAL_PAY_DAY = 0;
    char WS_CAL_FST_FLG = ' ';
    int WS_NEXT_VAL_DT = 0;
    int WS_NEXT_DUE_DT = 0;
    int WS_PLPI_DUE_DT = 0;
    short WS_MONTH_END = 0;
    short WS_IN_MONTH_END = 0;
    int WS_STANDARD_DATE = 0;
    int WS_I_CMP_VAL_DT = 0;
    int WS_I_CMP_DUE_DT = 0;
    int WS_P_CMP_VAL_DT = 0;
    int WS_P_CMP_DUE_DT = 0;
    short WS_I_CAL_TERM = 0;
    short WS_I_CMP_TERM = 0;
    int WS_I_CAL_VAL_DT = 0;
    int WS_I_CAL_DUE_DT = 0;
    short WS_P_CAL_TERM = 0;
    short WS_P_CMP_TERM = 0;
    int WS_P_CAL_VAL_DT = 0;
    int WS_P_CAL_DUE_DT = 0;
    short WS_MAX_PHS_NO = 0;
    int WS_DAYS1 = 0;
    short WS_BASDAYS = 0;
    int WS_OUT_DATE = 0;
    char WS_TERM_UNIT = ' ';
    int WS_YYYYMMDD1 = 0;
    LNZFCPL_REDEFINES77 REDEFINES77 = new LNZFCPL_REDEFINES77();
    LNZFCPL_WS_YYYYMMDD WS_YYYYMMDD = new LNZFCPL_WS_YYYYMMDD();
    int WS_IN_DATE = 0;
    LNZFCPL_WS_IN_YYYYMMDD WS_IN_YYYYMMDD = new LNZFCPL_WS_IN_YYYYMMDD();
    LNZFCPL_WS_TEMP_VAR WS_TEMP_VAR = new LNZFCPL_WS_TEMP_VAR();
    short WS_PLPI_MAX_TERM = 0;
    char WS_READ_LNTPLPI_FLG = ' ';
    char WS_READ_LNTLOAN_FLG = ' ';
    char WS_READ_LNTICTL_FLG = ' ';
    char WS_LOAN_SKIP_FLG = ' ';
    char WS_PLPI_P_SKIP_FLG = ' ';
    char WS_PLPI_I_SKIP_FLG = ' ';
    char WS_MONTH_END_FLAG = ' ';
    char WS_FIRST_REC_FLAG = ' ';
    char WS_PRO_END_FLAG = ' ';
    char WS_UP_ICTL_FLAG = ' ';
    char WS_FIRST_TERM_FLAG = ' ';
    char WS_LAST_TERM_FLAG = ' ';
    char WS_PHS_NO_ONE_FLAG = ' ';
    char WS_ERLY_RPY_FLAG = ' ';
    char WS_FULL_INT_FLG = ' ';
    char WS_CHANGE_FLG = ' ';
    char WS_DELAY_PAY_FLG = ' ';
    char WS_CANCEL_DELAY_FLG = ' ';
    LNCMSG_ERROR_MSG LNCMSG_ERROR_MSG = new LNCMSG_ERROR_MSG();
    SCCWOUT SCCWOUT = new SCCWOUT();
    BPRPARP BPRPARP = new BPRPARP();
    BPRPARM BPRPARM = new BPRPARM();
    SCCEXCP SCCEXCP = new SCCEXCP();
    SCCCALL SCCCALL = new SCCCALL();
    SCCMSG SCCMSG = new SCCMSG();
    SCCMPAG SCCMPAG = new SCCMPAG();
    LNRPAIP LNRPAIP = new LNRPAIP();
    LNRPLPI LNRPLPI = new LNRPLPI();
    LNCRPLPI LNCRPLPI = new LNCRPLPI();
    LNRICTL LNRICTL = new LNRICTL();
    LNCRICTL LNCRICTL = new LNCRICTL();
    LNRCONT LNRCONT = new LNRCONT();
    LNCRCONT LNCRCONT = new LNCRCONT();
    LNRLOAN LNRLOAN = new LNRLOAN();
    LNCRLOAN LNCRLOAN = new LNCRLOAN();
    SCCCLDT SCCCLDT = new SCCCLDT();
    LNCENSCH LNCENSCH = new LNCENSCH();
    LNCCMSCH LNCCMSCH = new LNCCMSCH();
    BPCSGSEQ BPCSGSEQ = new BPCSGSEQ();
    LNCSSCHE LNCSSCHE = new LNCSSCHE();
    LNCCNEX LNCCNEX = new LNCCNEX();
    LNCAPRDM LNCAPRDM = new LNCAPRDM();
    LNCSCKPD LNCSCKPD = new LNCSCKPD();
    LNCSPRIN LNCSPRIN = new LNCSPRIN();
    BPCQCCY BPCQCCY = new BPCQCCY();
    LNCICUT LNCICUT = new LNCICUT();
    LNCSCALT LNCSCALT = new LNCSCALT();
    LNRRATN LNRRATN = new LNRRATN();
    LNRPYIF LNRPYIF = new LNRPYIF();
    LNCILCM LNCILCM = new LNCILCM();
    LNCRATB LNCRATB = new LNCRATB();
    LNRSEAJ LNRSEAJ = new LNRSEAJ();
    DB2RTCD DB2RTCD = new DB2RTCD();
    String WS_MIN_CONTRAC_NO = " ";
    String WS_MAX_CONTRAC_NO = " ";
    short WS_TERM1 = 0;
    short WS_TERM2 = 0;
    short WS_TOT_CMP_TERM = 0;
    double WS_TOT_SUM = 0;
    short WS_PHS_NO_CAL = 0;
    short WS_PHS_NO_CMP = 0;
    double WS_TOT_REM_AMT = 0;
    int WS_TOT_CNT = 0;
    SCCGWA SCCGWA;
    SCCGBPA_BP_AREA GWA_BP_AREA;
    SCCGCPT SCCGCPT;
    BPRTRT SMRTRTT;
    LNCFCPL LNCFCPL;
    public void MP(SCCGWA SCCGWA, LNCFCPL LNCFCPL) throws IOException,SQLException,Exception {
        this.SCCGWA = SCCGWA;
        this.LNCFCPL = LNCFCPL;
        CEP.TRC(SCCGWA);
        A000_INIT_PROC();
        if (pgmRtn) return;
        B000_MAIN_PROC();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, "LNZFCPL return!");
        Z_RET();
        if (pgmRtn) return;
        JIBS_RETURN();
    }
    public void A000_INIT_PROC() throws IOException,SQLException,Exception {
        LNCFCPL.RC.RC_APP = "LN";
        LNCFCPL.RC.RC_RTNCODE = 0;
    }
    public void B000_MAIN_PROC() throws IOException,SQLException,Exception {
        B000_CHECK();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, LNRCONT.CONTRACT_TYPE);
        CEP.TRC(SCCGWA, LNCFCPL.COMM_DATA.PAY_MTH);
        CEP.TRC(SCCGWA, LNRCONT.MAT_DATE);
        CEP.TRC(SCCGWA, SCCGWA.COMM_AREA.AC_DATE);
        if (LNRICTL.CTL_STSW == null) LNRICTL.CTL_STSW = "";
        JIBS_tmp_int = LNRICTL.CTL_STSW.length();
        for (int i=0;i<128-JIBS_tmp_int;i++) LNRICTL.CTL_STSW += " ";
        if (LNRICTL.CTL_STSW == null) LNRICTL.CTL_STSW = "";
        JIBS_tmp_int = LNRICTL.CTL_STSW.length();
        for (int i=0;i<128-JIBS_tmp_int;i++) LNRICTL.CTL_STSW += " ";
        if (LNRICTL.CTL_STSW == null) LNRICTL.CTL_STSW = "";
        JIBS_tmp_int = LNRICTL.CTL_STSW.length();
        for (int i=0;i<128-JIBS_tmp_int;i++) LNRICTL.CTL_STSW += " ";
        if (LNRCONT.CONTRACT_TYPE.equalsIgnoreCase("CLDD") 
            && !LNRICTL.CTL_STSW.substring(74 - 1, 74 + 1 - 1).equalsIgnoreCase("1") 
            && !LNRICTL.CTL_STSW.substring(4 - 1, 4 + 1 - 1).equalsIgnoreCase("1") 
            && !LNRICTL.CTL_STSW.substring(47 - 1, 47 + 1 - 1).equalsIgnoreCase("1") 
            && LNRCONT.MAT_DATE >= SCCGWA.COMM_AREA.AC_DATE) {
            if (LNCFCPL.COMM_DATA.PAY_MTH == '2') {
                B100_CREATE_INT_RTN();
                if (pgmRtn) return;
            } else if (LNCFCPL.COMM_DATA.PAY_MTH == '3') {
                B100_CREATE_INT_RTN();
                if (pgmRtn) return;
                B200_CREATE_PYP_RTN();
                if (pgmRtn) return;
            } else if (LNCFCPL.COMM_DATA.PAY_MTH == '4') {
                B300_CREATE_CAL_RTN();
                if (pgmRtn) return;
            } else if (LNCFCPL.COMM_DATA.PAY_MTH == '5') {
                B200_CREATE_PYP_RTN();
                if (pgmRtn) return;
            } else {
                CEP.TRC(SCCGWA, "LAST CHECK REJECT.");

package com.hisun.LN;

import com.hisun.SC.*;
import com.hisun.BP.*;

import java.io.IOException;
import java.sql.SQLException;

public class LNZELDAD {
    int JIBS_tmp_int;
    String JIBS_tmp_str[] = new String[10];
    DBParm LNTCONT_RD;
    boolean pgmRtn = false;
    char K_ERROR = 'E';
    LNZELDAD_WS_TEMP_VARIABLE WS_TEMP_VARIABLE = new LNZELDAD_WS_TEMP_VARIABLE();
    SCCSUBS SCCSUBS = new SCCSUBS();
    LNCMSG_ERROR_MSG LNCMSG_ERROR_MSG = new LNCMSG_ERROR_MSG();
    BPCPQORG BPCPQORG = new BPCPQORG();
    LNCAPRDM LNCAPRDM = new LNCAPRDM();
    LNCICTLM LNCICTLM = new LNCICTLM();
    LNRCONT LNRCONT = new LNRCONT();
    LNCSWLAD LNCSWLAD = new LNCSWLAD();
    LNCSCLR LNCSCLR = new LNCSCLR();
    LNCSCLRR LNCSCLRR = new LNCSCLRR();
    LNCSPDQ LNCSPDQ = new LNCSPDQ();
    SCCMSG SCCMSG = new SCCMSG();
    SCCEXCP SCCEXCP = new SCCEXCP();
    SCCCALL SCCCALL = new SCCCALL();
    SCCFMT SCCFMT = new SCCFMT();
    SCCGWA SCCGWA;
    SCCGBPA_BP_AREA GWA_BP_AREA;
    SCCGSCA_SC_AREA GWA_SC_AREA;
    LNCELDAD LNCELDAD;
    public void MP(SCCGWA SCCGWA, LNCELDAD LNCELDAD) throws IOException,SQLException,Exception {
        this.SCCGWA = SCCGWA;
        this.LNCELDAD = LNCELDAD;
        CEP.TRC(SCCGWA);
        A000_INIT_PROCESS();
        if (pgmRtn) return;
        A100_CHECK_PROCESS();
        if (pgmRtn) return;
        B000_MAIN_PROCESS();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, "LNZELDAD return!");
        Z_RET();
        if (pgmRtn) return;
    }
    public void A000_INIT_PROCESS() throws IOException,SQLException,Exception {
        GWA_BP_AREA = (SCCGBPA_BP_AREA) SCCGWA.BP_AREA_PTR;
        GWA_SC_AREA = (SCCGSCA_SC_AREA) SCCGWA.SC_AREA_PTR;
        LNCELDAD.RC.RC_APP = "LN";
        LNCELDAD.RC.RC_RTNCODE = 0;
        IBS.init(SCCGWA, WS_TEMP_VARIABLE);
    }
    public void A100_CHECK_PROCESS() throws IOException,SQLException,Exception {
        if (LNCELDAD.COMM_DATA.CI_NO.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_CINO_MUST_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.DRAW_NO.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_E_INPUT_PAPER_NO, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.BOOK_BR == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_BK_BR_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        } else {
            IBS.init(SCCGWA, BPCPQORG);
            BPCPQORG.BR = LNCELDAD.COMM_DATA.BOOK_BR;
            S000_CALL_BPZPQORG();
            if (pgmRtn) return;
        }
        CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.INIT_AC);
        if (LNCELDAD.COMM_DATA.INIT_AC.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_INIT_AC_I, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.I_TO_P != 'Y' 
            && LNCELDAD.COMM_DATA.I_TO_P != 'N') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ITOP_FLG_I, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.CLR_I != 'Y' 
            && LNCELDAD.COMM_DATA.CLR_I != 'N') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_CLRI_FLG_I, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.PROD_CD);
        if (LNCELDAD.COMM_DATA.PROD_CD.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_PRDCD_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.CCY.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_CCY_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.CONT_AMT <= 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_CONT_AMT_MUST_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.DUE_DT == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_MUST_I_MATU_DT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.REPY_MTH == ' ') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_REPYMTH_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.PAY_DTYP != '1' 
            && LNCELDAD.COMM_DATA.PAY_DTYP != '2') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_PAY_DTYP_VAL_ERR, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.YHS_FLG != 'Y' 
            && LNCELDAD.COMM_DATA.YHS_FLG != 'N') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_YHS_FLG_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.REPY_MTH == '4' 
            && LNCELDAD.COMM_DATA.PHS_FLG == 'N') {
            if (LNCELDAD.COMM_DATA.INST_MTH == ' ') {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_INST_MTH_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC_CONTINUE();
                if (pgmRtn) return;
            }
        }
        if (LNCELDAD.COMM_DATA.YHS_FLG == 'Y' 
            && LNCELDAD.COMM_DATA.YHS_AC.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_YHSAC_M_INPUT, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.PYP_CIRC == ' ' 
            && LNCELDAD.COMM_DATA.REPY_MTH != '5') {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_PYP_CIRC_M, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (LNCELDAD.COMM_DATA.GRA_TYP == '2' 
            && LNCELDAD.COMM_DATA.GRA_DAYS_ACC == 0) {
            IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_GRA_DAYS, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
        if (SCCGWA.COMM_AREA.MSG_PROC_AREA.MSG_TYPE == K_ERROR) {
            S000_ERR_MSG_PROC_LAST();
            if (pgmRtn) return;
        }
    }
    public void B000_MAIN_PROCESS() throws IOException,SQLException,Exception {
        B100_CHECK_VALIDATION();
        if (pgmRtn) return;
        B200_ELD_DRAWDWN_PROC();
        if (pgmRtn) return;
    }
    public void B100_CHECK_VALIDATION() throws IOException,SQLException,Exception {
        if (SCCGWA.COMM_AREA.CANCEL_IND != 'Y') {
            IBS.init(SCCGWA, LNRCONT);
            CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.INIT_AC);
            LNRCONT.KEY.CONTRACT_NO = LNCELDAD.COMM_DATA.INIT_AC;
            CEP.TRC(SCCGWA, LNRCONT.KEY.CONTRACT_NO);
            T000_READ_CONT();
            if (pgmRtn) return;
            if (WS_TEMP_VARIABLE.WS_READ_LNTCONT_FLG == 'N') {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_CONT_NOTFND, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            if (!LNRCONT.CCY.equalsIgnoreCase(LNCELDAD.COMM_DATA.CCY)) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_NOT_IN_SAME_CCY, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            if (SCCGWA.COMM_AREA.AC_DATE < LNRCONT.LAST_F_VAL_DATE) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_VAL_DT_LESS_GT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            IBS.init(SCCGWA, LNCICTLM);
            LNCICTLM.FUNC = '3';
            LNCICTLM.REC_DATA.KEY.CONTRACT_NO = LNCELDAD.COMM_DATA.INIT_AC;
            LNCICTLM.REC_DATA.KEY.SUB_CTA_NO = 0;
            S000_CALL_LNZICTLM();
            if (pgmRtn) return;
            if (LNCICTLM.REC_DATA.CTL_STSW == null) LNCICTLM.REC_DATA.CTL_STSW = "";
            JIBS_tmp_int = LNCICTLM.REC_DATA.CTL_STSW.length();
            for (int i=0;i<128-JIBS_tmp_int;i++) LNCICTLM.REC_DATA.CTL_STSW += " ";
            if (LNCICTLM.REC_DATA.CTL_STSW == null) LNCICTLM.REC_DATA.CTL_STSW = "";
            JIBS_tmp_int = LNCICTLM.REC_DATA.CTL_STSW.length();
            for (int i=0;i<128-JIBS_tmp_int;i++) LNCICTLM.REC_DATA.CTL_STSW += " ";
            if (LNCICTLM.REC_DATA.CTL_STSW == null) LNCICTLM.REC_DATA.CTL_STSW = "";
            JIBS_tmp_int = LNCICTLM.REC_DATA.CTL_STSW.length();
            for (int i=0;i<128-JIBS_tmp_int;i++) LNCICTLM.REC_DATA.CTL_STSW += " ";
            if (LNCICTLM.REC_DATA.CTL_STSW == null) LNCICTLM.REC_DATA.CTL_STSW = "";
            JIBS_tmp_int = LNCICTLM.REC_DATA.CTL_STSW.length();
            for (int i=0;i<128-JIBS_tmp_int;i++) LNCICTLM.REC_DATA.CTL_STSW += " ";
            if (LNCICTLM.REC_DATA.CTL_STSW.substring(4 - 1, 4 + 1 - 1).equalsIgnoreCase("1") 
                || LNCICTLM.REC_DATA.CTL_STSW.substring(47 - 1, 47 + 1 - 1).equalsIgnoreCase("1") 
                || LNCICTLM.REC_DATA.CTL_STSW.substring(51 - 1, 51 + 1 - 1).equalsIgnoreCase("1") 
                || LNCICTLM.REC_DATA.CTL_STSW.substring(54 - 1, 54 + 1 - 1).equalsIgnoreCase("1")) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ELD_AC_STS, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            IBS.init(SCCGWA, LNCAPRDM);
            LNCAPRDM.FUNC = '3';
            LNCAPRDM.REC_DATA.KEY.CONTRACT_NO = LNCELDAD.COMM_DATA.INIT_AC;
            S000_CALL_LNZAPRDM();
            if (pgmRtn) return;
            if (!LNRCONT.CONTRACT_TYPE.equalsIgnoreCase("CLDD")) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_NON_CLDD_PROD, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.VAL_DT);
            CEP.TRC(SCCGWA, SCCGWA.COMM_AREA.AC_DATE);
            if (LNCELDAD.COMM_DATA.VAL_DT != SCCGWA.COMM_AREA.AC_DATE) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_VAL_DT_MEQ_AC_DT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            IBS.init(SCCGWA, LNCSPDQ);
            LNCSPDQ.COMM_DATA.CTA_INFO.CTA_NO = LNCELDAD.COMM_DATA.INIT_AC;
            LNCSPDQ.COMM_DATA.TR_VAL_DATE = SCCGWA.COMM_AREA.AC_DATE;
            S000_CALL_LNZSPDQ();
            if (pgmRtn) return;
            WS_TEMP_VARIABLE.WS_TOT_PRIN = LNCSPDQ.COMM_DATA.CTA_INFO.P_P_BAL + LNCSPDQ.COMM_DATA.CTA_INFO.O_P_BAL;
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.CTA_INFO.P_P_BAL);
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.CTA_INFO.O_P_BAL);
            CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_TOT_PRIN);
            if (WS_TEMP_VARIABLE.WS_TOT_PRIN <= 0) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ELD_REC_PRIN, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            WS_TEMP_VARIABLE.WS_TOT_INT = LNCSPDQ.COMM_DATA.CTA_INFO.D_I_AMT + LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_I_AMT + LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_O_AMT + LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_L_AMT;
            CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_TOT_INT);
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.CTA_INFO.D_I_AMT);
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_I_AMT);
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_O_AMT);
            CEP.TRC(SCCGWA, LNCSPDQ.COMM_DATA.TOT_AMTS.TOT_L_AMT);
            if (LNCELDAD.COMM_DATA.CLR_I == 'Y' 
                && WS_TEMP_VARIABLE.WS_TOT_INT != 0) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ELD_REC_INT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            WS_TEMP_VARIABLE.WS_TOT_AMT = WS_TEMP_VARIABLE.WS_TOT_PRIN + WS_TEMP_VARIABLE.WS_TOT_INT;
            CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.CONT_AMT);
            CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_TOT_AMT);
            if (LNCELDAD.COMM_DATA.I_TO_P == 'Y' 
                && LNCELDAD.COMM_DATA.CONT_AMT != WS_TEMP_VARIABLE.WS_TOT_AMT) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ELDAD_CONT_AMT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
            if (LNCELDAD.COMM_DATA.I_TO_P == 'N' 
                && LNCELDAD.COMM_DATA.CONT_AMT != WS_TEMP_VARIABLE.WS_TOT_PRIN) {
                IBS.CPY2CLS(SCCGWA, LNCMSG_ERROR_MSG.LN_ERR_ELDAD_CONT_AMT, WS_TEMP_VARIABLE.WS_MSGID);
                S000_ERR_MSG_PROC();
                if (pgmRtn) return;
            }
        }
    }
    public void B200_ELD_DRAWDWN_PROC() throws IOException,SQLException,Exception {
        if (SCCGWA.COMM_AREA.CANCEL_IND == 'Y') {
            IBS.init(SCCGWA, LNCSCLRR);
            LNCSCLRR.COMM_DATA.CTA_NO = LNCELDAD.COMM_DATA.INIT_AC;
            LNCSCLRR.COMM_DATA.PAY_DATA[1-1].REC_AC2 = LNCELDAD.COMM_DATA.DRAW_AC;
            LNCSCLRR.COMM_DATA.NOR_P = LNCELDAD.COMM_DATA.NOR_P;
            LNCSCLRR.COMM_DATA.OVR_P = LNCELDAD.COMM_DATA.OVR_P;
            LNCSCLRR.COMM_DATA.NOR_I = LNCELDAD.COMM_DATA.NOR_I;
            LNCSCLRR.COMM_DATA.OVR_I = LNCELDAD.COMM_DATA.OVR_I;
            LNCSCLRR.COMM_DATA.NOR_O = LNCELDAD.COMM_DATA.NOR_O;
            LNCSCLRR.COMM_DATA.NOR_L = LNCELDAD.COMM_DATA.NOR_L;
            LNCSCLRR.COMM_DATA.PC_CLR_FLG = 'N';
            LNCSCLRR.COMM_DATA.P_CLR_FLG = 'Y';
            LNCSCLRR.COMM_DATA.TR_VAL_DT = GWA_BP_AREA.CANCEL_AREA.CAN_AC_DATE;
            CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.I_TO_P);
            if (LNCELDAD.COMM_DATA.I_TO_P == 'N') {
                LNCSCLRR.COMM_DATA.I_CLR_FLG = 'N';
            } else {
                LNCSCLRR.COMM_DATA.I_CLR_FLG = 'Y';
            }
            if (LNCELDAD.COMM_DATA.CCY.equalsIgnoreCase("156")) {
                LNCSCLRR.COMM_DATA.CCY_TYP = '1';
            } else {
                LNCSCLRR.COMM_DATA.CCY_TYP = '2';
            }
            S000_CALL_LNZSCLRR();
            if (pgmRtn) return;
            B300_MAIN_PROCESS();
            if (pgmRtn) return;
        } else {
            B300_MAIN_PROCESS();
            if (pgmRtn) return;
            IBS.init(SCCGWA, LNCSCLR);
            LNCSCLR.COMM_DATA.CTA_NO = LNCELDAD.COMM_DATA.INIT_AC;
            LNCSCLR.COMM_DATA.PAY_DATA[1-1].REC_AC2 = LNCELDAD.COMM_DATA.DRAW_AC;
            LNCSCLR.COMM_DATA.PC_CLR_FLG = 'N';
            LNCSCLR.COMM_DATA.P_CLR_FLG = 'Y';
            CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.I_TO_P);
            if (LNCELDAD.COMM_DATA.I_TO_P == 'N') {
                LNCSCLR.COMM_DATA.I_CLR_FLG = 'N';
            } else {
                LNCSCLR.COMM_DATA.I_CLR_FLG = 'Y';
            }
            if (LNCELDAD.COMM_DATA.CCY.equalsIgnoreCase("156")) {
                LNCSCLR.COMM_DATA.CCY_TYP = '1';
            } else {
                LNCSCLR.COMM_DATA.CCY_TYP = '2';
            }
            S000_CALL_LNZSCLR();
            if (pgmRtn) return;
            LNCELDAD.COMM_DATA.NOR_P = LNCSCLR.COMM_DATA.NOR_P;
            LNCELDAD.COMM_DATA.OVR_P = LNCSCLR.COMM_DATA.OVR_P;
            LNCELDAD.COMM_DATA.NOR_I = LNCSCLR.COMM_DATA.NOR_I;
            LNCELDAD.COMM_DATA.OVR_I = LNCSCLR.COMM_DATA.OVR_I;
            LNCELDAD.COMM_DATA.NOR_O = LNCSCLR.COMM_DATA.NOR_O;
            LNCELDAD.COMM_DATA.NOR_L = LNCSCLR.COMM_DATA.NOR_L;
        }
    }
    public void B300_MAIN_PROCESS() throws IOException,SQLException,Exception {
        IBS.init(SCCGWA, LNCSWLAD);
        LNCSWLAD.COMM_DATA.DRAWR_NO = LNCELDAD.COMM_DATA.DRAW_NO;
        LNCSWLAD.COMM_DATA.PAPER_NO = LNCELDAD.COMM_DATA.PAPER_NO;
        LNCSWLAD.COMM_DATA.CTA_NO = LNCELDAD.COMM_DATA.CTA_NO;
        LNCSWLAD.COMM_DATA.CI_NO = LNCELDAD.COMM_DATA.CI_NO;
        LNCSWLAD.COMM_DATA.BOOK_BR = LNCELDAD.COMM_DATA.BOOK_BR;
        LNCSWLAD.COMM_DATA.DOMI_BR = LNCELDAD.COMM_DATA.DOMI_BR;
        LNCSWLAD.COMM_DATA.PROD_CD = LNCELDAD.COMM_DATA.PROD_CD;
        LNCSWLAD.COMM_DATA.VCH_FLG = LNCELDAD.COMM_DATA.VCH_FLG;
        LNCSWLAD.COMM_DATA.CCY = LNCELDAD.COMM_DATA.CCY;
        if (LNCELDAD.COMM_DATA.CCY.equalsIgnoreCase("156")) {
            LNCSWLAD.COMM_DATA.CCY_TYP = '1';
        } else {
            LNCSWLAD.COMM_DATA.CCY_TYP = '2';
        }
        LNCSWLAD.COMM_DATA.CONT_AMT = LNCELDAD.COMM_DATA.CONT_AMT;
        LNCSWLAD.COMM_DATA.PRINCIPAL = LNCELDAD.COMM_DATA.CONT_AMT;
        LNCSWLAD.COMM_DATA.VAL_DT = LNCELDAD.COMM_DATA.VAL_DT;
        LNCSWLAD.COMM_DATA.INT_PER_STRT = LNCELDAD.COMM_DATA.VAL_DT;
        LNCSWLAD.COMM_DATA.ACTV_DT = LNCELDAD.COMM_DATA.VAL_DT;
        LNCSWLAD.COMM_DATA.VRTU_FLG = 'Y';
        LNCSWLAD.COMM_DATA.DUE_DT = LNCELDAD.COMM_DATA.DUE_DT;
        LNCSWLAD.COMM_DATA.CUSTM1 = LNCELDAD.COMM_DATA.CUSTM1;
        LNCSWLAD.COMM_DATA.CUSTM2 = LNCELDAD.COMM_DATA.CUSTM2;
        LNCSWLAD.COMM_DATA.CUSTM3 = LNCELDAD.COMM_DATA.CUSTM3;
        LNCSWLAD.COMM_DATA.BAR_CD = LNCELDAD.COMM_DATA.BAR_CD;
        LNCSWLAD.COMM_DATA.UNIT_CD = LNCELDAD.COMM_DATA.UNIT_CD;
        LNCSWLAD.COMM_DATA.INT_RATE_TYPE = "" + LNCELDAD.COMM_DATA.INT_RATT;
        JIBS_tmp_int = LNCSWLAD.COMM_DATA.INT_RATE_TYPE.length();
        for (int i=0;i<1-JIBS_tmp_int;i++) LNCSWLAD.COMM_DATA.INT_RATE_TYPE = "0" + LNCSWLAD.COMM_DATA.INT_RATE_TYPE;
        LNCSWLAD.COMM_DATA.ALL_IN_RATE = LNCELDAD.COMM_DATA.INT_IRA;
        LNCSWLAD.COMM_DATA.PEN_RATT = LNCELDAD.COMM_DATA.PEN_RATT;
        LNCSWLAD.COMM_DATA.PEN_IRAT = LNCELDAD.COMM_DATA.PEN_IRA;
        LNCSWLAD.COMM_DATA.CPND_USE = LNCELDAD.COMM_DATA.CPND_USE;
        LNCSWLAD.COMM_DATA.CPND_RATT = LNCELDAD.COMM_DATA.CPNDRATT;
        LNCSWLAD.COMM_DATA.CPND_IRATE = LNCELDAD.COMM_DATA.CPND_IRA;
        LNCSWLAD.COMM_DATA.ABUS_RATTYPE = "" + LNCELDAD.COMM_DATA.ABUSRATT;
        JIBS_tmp_int = LNCSWLAD.COMM_DATA.ABUS_RATTYPE.length();
        for (int i=0;i<1-JIBS_tmp_int;i++) LNCSWLAD.COMM_DATA.ABUS_RATTYPE = "0" + LNCSWLAD.COMM_DATA.ABUS_RATTYPE;
        LNCSWLAD.COMM_DATA.ABUS_IRAT = LNCELDAD.COMM_DATA.ABUS_IRA;
        LNCSWLAD.COMM_DATA.REPY_MTH = LNCELDAD.COMM_DATA.REPY_MTH;
        LNCSWLAD.COMM_DATA.PAYI_PERD = LNCELDAD.COMM_DATA.PAYI_PER;
        LNCSWLAD.COMM_DATA.CAL_PERD_UNIT = LNCELDAD.COMM_DATA.CAL_PERU;
        LNCSWLAD.COMM_DATA.CAL_PERD = LNCELDAD.COMM_DATA.CAL_PERD;
        LNCSWLAD.COMM_DATA.CAL_PAY_DAY_TYP = LNCELDAD.COMM_DATA.PAY_DTYP;
        LNCSWLAD.COMM_DATA.CAL_PAY_DAY = LNCELDAD.COMM_DATA.CAL_PAY_DAY;
        LNCSWLAD.COMM_DATA.CAL_FST_DT = LNCELDAD.COMM_DATA.CAL_FSDT;
        LNCSWLAD.COMM_DATA.PYP_CIRC = LNCELDAD.COMM_DATA.PYP_CIRC;
        LNCSWLAD.COMM_DATA.PAYP_PERU = LNCELDAD.COMM_DATA.PYP_PERU;
        LNCSWLAD.COMM_DATA.PAYP_PERD = LNCELDAD.COMM_DATA.PYP_PERD;
        LNCSWLAD.COMM_DATA.INST_MTH = LNCELDAD.COMM_DATA.INST_MTH;
        LNCSWLAD.COMM_DATA.SP_LNFLG = LNCELDAD.COMM_DATA.SP_LNFLG;
        LNCSWLAD.COMM_DATA.PHS_FLG = LNCELDAD.COMM_DATA.PHS_FLG;
        LNCSWLAD.COMM_DATA.PHS_NUM = LNCELDAD.COMM_DATA.PHS_NUM;
        LNCSWLAD.COMM_DATA.FLT_MTH = LNCELDAD.COMM_DATA.FLT_MTH;
        LNCSWLAD.COMM_DATA.FLT_PERD_UNIT = LNCELDAD.COMM_DATA.FLT_PERD_UNIT;
        LNCSWLAD.COMM_DATA.FLT_PERD = LNCELDAD.COMM_DATA.FLT_PERD;
        LNCSWLAD.COMM_DATA.FLT_IPER = LNCELDAD.COMM_DATA.FLT_IPER;
        LNCSWLAD.COMM_DATA.FLT_ADJF = LNCELDAD.COMM_DATA.FLT_ADJF;
        LNCSWLAD.COMM_DATA.FIRST_FLT_FLG = LNCELDAD.COMM_DATA.FIRST_FLT_FLG;
        LNCSWLAD.COMM_DATA.FIRST_FIX_DATE = LNCELDAD.COMM_DATA.FIRST_FIX_DATE;
        LNCSWLAD.COMM_DATA.FIRST_FLT_DT = LNCELDAD.COMM_DATA.FIRST_FLT_DT;
        LNCSWLAD.COMM_DATA.NFLT_METHOD = LNCELDAD.COMM_DATA.NFLT_METHOD;
        LNCSWLAD.COMM_DATA.INT_RATE_TYPE = LNCELDAD.COMM_DATA.INT_RATE_TYPE;
        LNCSWLAD.COMM_DATA.INT_RATE_CLAS = LNCELDAD.COMM_DATA.INT_RATE_CLAS;
        LNCSWLAD.COMM_DATA.RATE_VAR = LNCELDAD.COMM_DATA.RATE_VAR;
        LNCSWLAD.COMM_DATA.RATE_PCT = LNCELDAD.COMM_DATA.RATE_PCT;
        LNCSWLAD.COMM_DATA.RAT_INT = LNCELDAD.COMM_DATA.RAT_INT;
        LNCSWLAD.COMM_DATA.PEN_RRAT = LNCELDAD.COMM_DATA.PEN_RRAT;
        LNCSWLAD.COMM_DATA.PEN_TYPE = LNCELDAD.COMM_DATA.PEN_TYPE;
        LNCSWLAD.COMM_DATA.PEN_RATT = LNCELDAD.COMM_DATA.PEN_RATT;
        LNCSWLAD.COMM_DATA.PEN_RATC = LNCELDAD.COMM_DATA.PEN_RATC;
        LNCSWLAD.COMM_DATA.PEN_SPR = LNCELDAD.COMM_DATA.PEN_SPR;
        LNCSWLAD.COMM_DATA.PEN_PCT = LNCELDAD.COMM_DATA.PEN_PCT;
        LNCSWLAD.COMM_DATA.PEN_IRAT = LNCELDAD.COMM_DATA.PEN_IRAT;
        LNCSWLAD.COMM_DATA.CPND_USE = LNCELDAD.COMM_DATA.CPND_USE;
        LNCSWLAD.COMM_DATA.INT_MTH = LNCELDAD.COMM_DATA.INT_MTH;
        LNCSWLAD.COMM_DATA.CPND_RTYPE = LNCELDAD.COMM_DATA.CPND_RTYPE;
        LNCSWLAD.COMM_DATA.CPND_TYP = LNCELDAD.COMM_DATA.CPND_TYP;
        LNCSWLAD.COMM_DATA.CPND_RATT = LNCELDAD.COMM_DATA.CPND_RATT;
        LNCSWLAD.COMM_DATA.CPND_RATC = LNCELDAD.COMM_DATA.CPND_RATC;
        LNCSWLAD.COMM_DATA.CPND_SPR = LNCELDAD.COMM_DATA.CPND_SPR;
        LNCSWLAD.COMM_DATA.CPND_PCT = LNCELDAD.COMM_DATA.CPND_PCT;
        LNCSWLAD.COMM_DATA.CPND_IRATE = LNCELDAD.COMM_DATA.CPND_IRATE;
        for (WS_TEMP_VARIABLE.WS_IDX = 1; WS_TEMP_VARIABLE.WS_IDX <= 5; WS_TEMP_VARIABLE.WS_IDX += 1) {
            LNCSWLAD.COMM_DATA.PHS_DATA[WS_TEMP_VARIABLE.WS_IDX-1].PHS_TOT_TERM = LNCELDAD.COMM_DATA.PHS_INFO[WS_TEMP_VARIABLE.WS_IDX-1].PHS_TTRM;
            LNCSWLAD.COMM_DATA.PHS_DATA[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PERU = LNCELDAD.COMM_DATA.PHS_INFO[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PERU;
            LNCSWLAD.COMM_DATA.PHS_DATA[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PERD = LNCELDAD.COMM_DATA.PHS_INFO[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PERD;
            LNCSWLAD.COMM_DATA.PHS_DATA[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PRIN_AMT = LNCELDAD.COMM_DATA.PHS_INFO[WS_TEMP_VARIABLE.WS_IDX-1].PHS_PAMT;
            LNCSWLAD.COMM_DATA.PHS_DATA[WS_TEMP_VARIABLE.WS_IDX-1].PHS_INST_MTH = LNCELDAD.COMM_DATA.PHS_INFO[WS_TEMP_VARIABLE.WS_IDX-1].PHS_ISMT;
        }
        for (WS_TEMP_VARIABLE.WS_IDX = 1; WS_TEMP_VARIABLE.WS_IDX <= 5; WS_TEMP_VARIABLE.WS_IDX += 1) {
            LNCSWLAD.COMM_DATA.FEE_DATE[WS_TEMP_VARIABLE.WS_IDX-1].FEE_CODE = LNCELDAD.COMM_DATA.FEE_INFO[WS_TEMP_VARIABLE.WS_IDX-1].FEE_CODE;
            LNCSWLAD.COMM_DATA.FEE_DATE[WS_TEMP_VARIABLE.WS_IDX-1].FEE_AMT = LNCELDAD.COMM_DATA.FEE_INFO[WS_TEMP_VARIABLE.WS_IDX-1].FEE_AMT;
            if (LNCELDAD.COMM_DATA.FEE_INFO[WS_TEMP_VARIABLE.WS_IDX-1].FEE_CODE.trim().length() > 0) {
                WS_TEMP_VARIABLE.WS_FEE_CNT += 1;
            }
        }
        LNCSWLAD.COMM_DATA.FEE_CNT = WS_TEMP_VARIABLE.WS_FEE_CNT;
        CEP.TRC(SCCGWA, LNCSWLAD.COMM_DATA.FEE_CNT);
        LNCSWLAD.COMM_DATA.FEE_AC_TYP = LNCELDAD.COMM_DATA.FEE_ACT;
        LNCSWLAD.COMM_DATA.FEE_AC = LNCELDAD.COMM_DATA.FEE_AC;
        LNCSWLAD.COMM_DATA.OCAL_PERD_UNIT = LNCELDAD.COMM_DATA.OLC_PERU;
        LNCSWLAD.COMM_DATA.OCAL_PERD = LNCELDAD.COMM_DATA.OLC_PERD;
        LNCSWLAD.COMM_DATA.DRAW_AC_TYP = LNCELDAD.COMM_DATA.DRAW_AC_TYP;
        LNCSWLAD.COMM_DATA.DRAW_AC = LNCELDAD.COMM_DATA.DRAW_AC;
        LNCSWLAD.COMM_DATA.DRAW_BK_TP = LNCELDAD.COMM_DATA.DRAW_BK_TP;
        LNCSWLAD.COMM_DATA.DRAW_SEQ = LNCELDAD.COMM_DATA.DRAW_SEQ;
        LNCSWLAD.COMM_DATA.PAY_AC_TYP = LNCELDAD.COMM_DATA.PAY_AC_TYP;
        LNCSWLAD.COMM_DATA.PAY_AC = LNCELDAD.COMM_DATA.PAY_AC;
        LNCSWLAD.COMM_DATA.PAY_BK_TP = LNCELDAD.COMM_DATA.PAY_BK_TP;
        LNCSWLAD.COMM_DATA.GUAP_REF = LNCELDAD.COMM_DATA.GUAPREF;
        LNCSWLAD.COMM_DATA.GUAR_DUE_AP = LNCELDAD.COMM_DATA.GUARDUAP;
        LNCSWLAD.COMM_DATA.GUAR_PAY_SEQ = LNCELDAD.COMM_DATA.GUARPSEQ;
        LNCSWLAD.COMM_DATA.GRA_TYP = LNCELDAD.COMM_DATA.GRA_TYP;
        LNCSWLAD.COMM_DATA.GRA_DAYS_ACC = LNCELDAD.COMM_DATA.GRA_DAYS_ACC;
        LNCSWLAD.COMM_DATA.P_GRA_MTH = LNCELDAD.COMM_DATA.P_GRA_MTH;
        LNCSWLAD.COMM_DATA.I_GRA_MTH = LNCELDAD.COMM_DATA.C_GRA_MTH;
        LNCSWLAD.COMM_DATA.INT_DAY_BASIS = LNCELDAD.COMM_DATA.INT_D_BA;
        LNCSWLAD.COMM_DATA.FS_CL_MTH = LNCELDAD.COMM_DATA.FS_CLMTH;
        LNCSWLAD.COMM_DATA.FS_CL_AMT = LNCELDAD.COMM_DATA.FS_CLAMT;
        LNCSWLAD.COMM_DATA.PAYI_ACT = LNCELDAD.COMM_DATA.PAYI_ACT;
        LNCSWLAD.COMM_DATA.PAYI_AC = LNCELDAD.COMM_DATA.PAYI_AC;
        LNCSWLAD.COMM_DATA.PAYI_SEQ = LNCELDAD.COMM_DATA.PAYI_SEQ;
        LNCSWLAD.COMM_DATA.YHS_FLG = LNCELDAD.COMM_DATA.YHS_FLG;
        LNCSWLAD.COMM_DATA.YHS_AC = LNCELDAD.COMM_DATA.YHS_AC;
        LNCSWLAD.COMM_DATA.TR_MMO = LNCELDAD.COMM_DATA.TR_MMO;
        LNCSWLAD.COMM_DATA.REMARK1 = LNCELDAD.COMM_DATA.REMARK1;
        S000_CALL_LNZSWLAD();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, LNCSWLAD.COMM_DATA.CTA_NO);
        CEP.TRC(SCCGWA, LNCELDAD.COMM_DATA.CTA_NO);
        CEP.TRC(SCCGWA, LNCSWLAD.COMM_DATA.CUS_AC);
    }
    public void S000_CALL_BPZPQORG() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "BP-P-INQ-ORG", BPCPQORG);
        if (BPCPQORG.RC.RC_CODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, BPCPQORG.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC_CONTINUE();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZAPRDM() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SRC-APRD-MAINT", LNCAPRDM);
        if (LNCAPRDM.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCAPRDM.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            Z_RET();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZICTLM() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SRC-ICTL-MAINT", LNCICTLM);
        if (LNCICTLM.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCICTLM.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZELDAD() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-S-ELD-ADD", LNCELDAD);
        if (LNCELDAD.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCELDAD.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZSCLR() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SVR-CLEAR", LNCSCLR);
        if (LNCSCLR.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCSCLR.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZSPDQ() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SRV-PSTDUE-ENQ", LNCSPDQ, true);
        CEP.TRC(SCCGWA, LNCSPDQ.RC);
        if (LNCSPDQ.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCSPDQ.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
        CEP.TRC(SCCGWA, LNCSPDQ.RC);
    }
    public void S000_CALL_LNZSCLRR() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SVR-CLEAR-REV", LNCSCLRR);
        if (LNCSCLRR.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCSCLRR.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
    }
    public void T000_READ_CONT() throws IOException,SQLException,Exception {
        LNTCONT_RD = new DBParm();
        LNTCONT_RD.TableName = "LNTCONT";
        IBS.READ(SCCGWA, LNRCONT, LNTCONT_RD);
        if (SCCGWA.COMM_AREA.DBIO_FLG == '0') {
            WS_TEMP_VARIABLE.WS_READ_LNTCONT_FLG = 'F';
        } else if (SCCGWA.COMM_AREA.DBIO_FLG == '1') {
            WS_TEMP_VARIABLE.WS_READ_LNTCONT_FLG = 'N';
        } else {
            IBS.init(SCCGWA, SCCEXCP);
            SCCEXCP.MSG_TEXT.MSG_TEXT_D.TABLE_NAME = "LNTCONT";
            SCCEXCP.MSG_TEXT.SYS_INFO = IBS.CLS2CPY(SCCGWA, SCCEXCP.MSG_TEXT.MSG_TEXT_D);
            SCCEXCP.MSG_TEXT.MSG_TEXT_D.DB_FUNC = "READ";
            B_DB_EXCP();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_LNZSWLAD() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "LN-SVR-WLLOAN-ADD2DD", LNCSWLAD);
        if (LNCSWLAD.RC.RC_RTNCODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, LNCSWLAD.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_MSGID);
            CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
            S000_ERR_MSG_PROC();
            if (pgmRtn) return;
        }
    }
    public void S000_ERR_MSG_PROC_CONTINUE() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
        JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
        CEP.ERRC(SCCGWA, JIBS_tmp_str[0], WS_TEMP_VARIABLE.WS_FLD_NO);
    }
    public void S000_ERR_MSG_PROC_LAST() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
        JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
        CEP.ERR(SCCGWA, JIBS_tmp_str[0]);
    }
    public void S000_ERR_MSG_PROC() throws IOException,SQLException,Exception {
        JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, WS_TEMP_VARIABLE.WS_MSGID);
        CEP.ERR(SCCGWA, JIBS_tmp_str[0]);
    }
    public void Z_RET() throws IOException,SQLException,Exception {
        pgmRtn = true;
        return;
    }
    public void B_DB_EXCP() throws IOException,SQLException,Exception {
        throw new SQLException(SCCGWA.e);
    }
}

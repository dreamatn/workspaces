package com.hisun.DC;

import com.hisun.SC.*;
import com.hisun.TC.XStreamUtil;

import java.io.IOException;
import java.sql.SQLException;

public class DCOT5901 {
    String WS_ERR_MSG = " ";
    short WS_FLD_NO = 0;
    DCCMSG_ERROR_MSG DCCMSG_ERROR_MSG = new DCCMSG_ERROR_MSG();
    SCCEXCP SCCEXCP = new SCCEXCP();
    SCCMSG SCCMSG = new SCCMSG();
    SCCFMT SCCFMT = new SCCFMT();
    SCCCALL SCCCALL = new SCCCALL();
    DCCSMPRD DCCSMPRD = new DCCSMPRD();
    SCCGWA SCCGWA;
    DCB5900_AWA_5900 DCB5900_AWA_5900;
    public void MP(SCCGWA SCCGWA) throws IOException,SQLException,Exception {
        this.SCCGWA = SCCGWA;
        CEP.TRC(SCCGWA);
        A000_INIT_PROC();
        B000_MAIN_PROC();
        CEP.TRC(SCCGWA, "DCOT5901 return!");
        Z_RET();
    }
    public void A000_INIT_PROC() throws IOException,SQLException,Exception {
        SCCGWA.COMM_AREA.AWA_AREA_PTR = SCCGWA.COMM_AREA.AWA_AREA_PTR.replaceAll("BODY>", "DCB5900_AWA_5900>");
        DCB5900_AWA_5900 = (DCB5900_AWA_5900) XStreamUtil.xmlToBean(SCCGWA.COMM_AREA.AWA_AREA_PTR);
    }
    public void B000_MAIN_PROC() throws IOException,SQLException,Exception {
        B010_CHECK_INPUT();
        B020_ADD_PRD_INFO();
    }
    public void B010_CHECK_INPUT() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.PROD_CD);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.NAME);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.STR_DATE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.EXP_DATE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.PRD_TYPE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CUS_TYPE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.APP1);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.APP2);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.APP3);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.APP4);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.APP5);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.INHERIT);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.VCH_TYPE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY_TYPE);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY1);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY2);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY3);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY4);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY5);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY6);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY7);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY8);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY9);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY10);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY11);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY12);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY13);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY14);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY15);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY16);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY17);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY18);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY19);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.CCY20);
        CEP.TRC(SCCGWA, DCB5900_AWA_5900.REMARK);
        if (DCB5900_AWA_5900.PROD_CD.trim().length() == 0) {
            WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_PROD_CD_M_INPUT;
            WS_FLD_NO = DCB5900_AWA_5900.PROD_CD_NO;
            S000_ERR_MSG_PROC_CONTINUE();
        }
        if (DCB5900_AWA_5900.STR_DATE == 0) {
            DCB5900_AWA_5900.STR_DATE = SCCGWA.COMM_AREA.AC_DATE;
        }
        if (DCB5900_AWA_5900.EXP_DATE == 0) {
            if ("99991231".trim().length() == 0) DCB5900_AWA_5900.EXP_DATE = 0;
            else DCB5900_AWA_5900.EXP_DATE = Integer.parseInt("99991231");
        }
        if (DCB5900_AWA_5900.STR_DATE >= DCB5900_AWA_5900.EXP_DATE) {
            WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_ST_DATE_GE_EX_DATE;
            WS_FLD_NO = DCB5900_AWA_5900.STR_DATE_NO;
            S000_ERR_MSG_PROC_CONTINUE();
        }
        if (DCB5900_AWA_5900.STR_DATE < SCCGWA.COMM_AREA.AC_DATE) {
            WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_STR_DATE_LT_CNT_DATE;
            WS_FLD_NO = DCB5900_AWA_5900.STR_DATE_NO;
            S000_ERR_MSG_PROC_CONTINUE();
        }
        if (DCB5900_AWA_5900.PRD_TYPE == '6' 
            || DCB5900_AWA_5900.PRD_TYPE == '7') {
            if (DCB5900_AWA_5900.CUS_TYPE == '2') {
                if (DCB5900_AWA_5900.INHERIT != 'Y') {
                    WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_INT_FLG_INVALID;
                    WS_FLD_NO = DCB5900_AWA_5900.INHERIT_NO;
                    S000_ERR_MSG_PROC_CONTINUE();
                }
            } else if (DCB5900_AWA_5900.CUS_TYPE == '3') {
                if (DCB5900_AWA_5900.INHERIT != 'Y') {
                    WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_INT_FLG_INVALID;
                    WS_FLD_NO = DCB5900_AWA_5900.INHERIT_NO;
                    S000_ERR_MSG_PROC_CONTINUE();
                }
            } else if (DCB5900_AWA_5900.CUS_TYPE == '1') {
                if (DCB5900_AWA_5900.INHERIT != 'N') {
                    WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_INT_FLG_INVALID;
                    WS_FLD_NO = DCB5900_AWA_5900.INHERIT_NO;
                    S000_ERR_MSG_PROC_CONTINUE();
                }
                if (DCB5900_AWA_5900.VCH_TYPE != '1') {
                    WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_VCH_TYP_INVALID;
                    WS_FLD_NO = DCB5900_AWA_5900.VCH_TYPE_NO;
                    S000_ERR_MSG_PROC_CONTINUE();
                }
            } else {
                WS_ERR_MSG = DCCMSG_ERROR_MSG.DC_CUS_TYP_INVALID;
                WS_FLD_NO = DCB5900_AWA_5900.CUS_TYPE_NO;
                S000_ERR_MSG_PROC_CONTINUE();
            }
        }
        S000_ERR_MSG_PROC_LAST();
    }
    public void B020_ADD_PRD_INFO() throws IOException,SQLException,Exception {
        IBS.init(SCCGWA, DCCSMPRD);
        DCCSMPRD.VAL.PROD_CD = DCB5900_AWA_5900.PROD_CD;
        DCCSMPRD.VAL.NAME = DCB5900_AWA_5900.NAME;
        DCCSMPRD.VAL.STR_DATE = DCB5900_AWA_5900.STR_DATE;
        DCCSMPRD.VAL.EXP_DATE = DCB5900_AWA_5900.EXP_DATE;
        DCCSMPRD.VAL.PRD_TYPE = DCB5900_AWA_5900.PRD_TYPE;
        DCCSMPRD.VAL.CUS_TYPE = DCB5900_AWA_5900.CUS_TYPE;
        DCCSMPRD.VAL.APP1 = DCB5900_AWA_5900.APP1;
        DCCSMPRD.VAL.APP2 = DCB5900_AWA_5900.APP2;
        DCCSMPRD.VAL.APP3 = DCB5900_AWA_5900.APP3;
        DCCSMPRD.VAL.APP4 = DCB5900_AWA_5900.APP4;
        DCCSMPRD.VAL.APP5 = DCB5900_AWA_5900.APP5;
        DCCSMPRD.VAL.INHERIT_FLG = DCB5900_AWA_5900.INHERIT;
        DCCSMPRD.VAL.VCH_TYPE = DCB5900_AWA_5900.VCH_TYPE;
        DCCSMPRD.VAL.CCY_TYPE = DCB5900_AWA_5900.CCY_TYPE;
        DCCSMPRD.VAL.CCY1 = DCB5900_AWA_5900.CCY1;
        DCCSMPRD.VAL.CCY2 = DCB5900_AWA_5900.CCY2;
        DCCSMPRD.VAL.CCY3 = DCB5900_AWA_5900.CCY3;
        DCCSMPRD.VAL.CCY4 = DCB5900_AWA_5900.CCY4;
        DCCSMPRD.VAL.CCY5 = DCB5900_AWA_5900.CCY5;
        DCCSMPRD.VAL.CCY6 = DCB5900_AWA_5900.CCY6;
        DCCSMPRD.VAL.CCY7 = DCB5900_AWA_5900.CCY7;
        DCCSMPRD.VAL.CCY8 = DCB5900_AWA_5900.CCY8;
        DCCSMPRD.VAL.CCY9 = DCB5900_AWA_5900.CCY9;
        DCCSMPRD.VAL.CCY10 = DCB5900_AWA_5900.CCY10;
        DCCSMPRD.VAL.CCY11 = DCB5900_AWA_5900.CCY11;
        DCCSMPRD.VAL.CCY12 = DCB5900_AWA_5900.CCY12;
        DCCSMPRD.VAL.CCY13 = DCB5900_AWA_5900.CCY13;
        DCCSMPRD.VAL.CCY14 = DCB5900_AWA_5900.CCY14;
        DCCSMPRD.VAL.CCY15 = DCB5900_AWA_5900.CCY15;
        DCCSMPRD.VAL.CCY16 = DCB5900_AWA_5900.CCY16;
        DCCSMPRD.VAL.CCY17 = DCB5900_AWA_5900.CCY17;
        DCCSMPRD.VAL.CCY18 = DCB5900_AWA_5900.CCY18;
        DCCSMPRD.VAL.CCY19 = DCB5900_AWA_5900.CCY19;
        DCCSMPRD.VAL.CCY20 = DCB5900_AWA_5900.CCY20;
        DCCSMPRD.VAL.REMARK = DCB5900_AWA_5900.REMARK;
        DCCSMPRD.FUNC = 'A';
        S000_CALL_DCZSMPRD();
    }
    public void S000_CALL_DCZSMPRD() throws IOException,SQLException,Exception {
        IBS.CALLCPN(SCCGWA, "DC-S-MOD-PRD", DCCSMPRD);
    }
    public void S000_ERR_MSG_PROC_CONTINUE() throws IOException,SQLException,Exception {
        CEP.ERRC(SCCGWA, WS_ERR_MSG, WS_FLD_NO);
    }
    public void S000_ERR_MSG_PROC_LAST() throws IOException,SQLException,Exception {
        CEP.ERR(SCCGWA, WS_ERR_MSG, WS_FLD_NO);
    }
    public void Z_RET() throws IOException,SQLException,Exception {
        return;
    }
    public void B_DB_EXCP() throws IOException,SQLException,Exception {
        throw new SQLException(SCCGWA.e);
    }
}

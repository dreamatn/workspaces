package com.hisun.BP;

import java.io.IOException;
import java.sql.SQLException;

import com.hisun.SC.SCCEXCP;
import com.hisun.SC.SCCGBPA_BP_AREA;
import com.hisun.SC.SCCGSCA_SC_AREA;
import com.hisun.SC.SCCGWA;

public class BPZRPENT {
    boolean pgmRtn = false;
    String K_PGM_NAME = "BPZRPENT";
    int WS_LEN = 0;
    short WS_CNT = 0;
    char WS_BPTPENT_FLG = ' ';
    BPCMSG_ERROR_MSG BPCMSG_ERROR_MSG = new BPCMSG_ERROR_MSG();
    SCCEXCP SCCEXCP = new SCCEXCP();
    BPRPENT BPRPENT = new BPRPENT();
    BPRENTY BPRENT = new BPRENTY();
    SCCGWA SCCGWA;
    BPCRPENT BPCRPENT;
    SCCGSCA_SC_AREA GWA_SC_AREA;
    SCCGBPA_BP_AREA GWA_BP_AREA;
    String LK_DATA = " ";
    public void MP(SCCGWA SCCGWA, BPCRPENT BPCRPENT) throws IOException,SQLException,Exception {
        this.SCCGWA = SCCGWA;
        this.BPCRPENT = BPCRPENT;
        CEP.TRC(SCCGWA);
        A000_INIT_PROC();
        if (pgmRtn) return;
        B000_MAIN_PROC();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, "BPZRPENT return!");
        Z_RET();
        if (pgmRtn) return;
        JIBS_RETURN();
    }
    public void A000_INIT_PROC() throws IOException,SQLException,Exception {
        LK_DATA = IBS.CLS2CPY(SCCGWA, BPCRPENT.DAT_POINTER);
        GWA_BP_AREA = (SCCGBPA_BP_AREA) SCCGWA.BP_AREA_PTR;
        GWA_SC_AREA = (SCCGSCA_SC_AREA) SCCGWA.SC_AREA_PTR;
        IBS.init(SCCGWA, BPRPENT);
    }
    public void B000_MAIN_PROC() throws IOException,SQLException,Exception {
        BPRPENT.KEY.TYPE = BPCRPENT.TYP;
        BPRPENT.KEY.CODE = BPCRPENT.CD;
        BPRPENT.KEY.EFF_DATE = BPCRPENT.EFF_DATE;
        if (BPCRPENT.FUNC == 'A') {
            B010_CREATE_RECORD_PROC();
            if (pgmRtn) return;
        } else if (BPCRPENT.FUNC == 'U') {
            B020_UPDATE_RECORD_PROC();
            if (pgmRtn) return;
        } else if (BPCRPENT.FUNC == 'D') {
            B030_DELETE_RECORD_PROC();
            if (pgmRtn) return;
        } else if (BPCRPENT.FUNC == 'Q') {
            B040_QUERY_RECORD_PROC();
            if (pgmRtn) return;
        } else {
            IBS.init(SCCGWA, SCCEXCP);
            SCCEXCP.MSG_TEXT.KEY_OR_OTHER = "INVALID FUNC(" + BPCRPENT.FUNC + ")";
            CEP.EXCP(SCCGWA, SCCEXCP.MSG_TEXT.KEY_OR_OTHER);
        }
    }
    public void B010_CREATE_RECORD_PROC() throws IOException,SQLException,Exception {
        if (LK_DATA == null) LK_DATA = "";
        JIBS_tmp_int = LK_DATA.length();
        for (int i=0;i<9500-JIBS_tmp_int;i++) LK_DATA += " ";
        IBS.CPY2CLS(SCCGWA, LK_DATA.substring(0, BPCRPENT.DAT_LEN), BPRENT.DATA_TXT);
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT);
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT.CNT);
        WS_CNT = 1;
        R010_PUT_IN();
        if (pgmRtn) return;
        T000_WRITE_BPTPENT();
        if (pgmRtn) return;
    }
    public void B020_UPDATE_RECORD_PROC() throws IOException,SQLException,Exception {
        if (LK_DATA == null) LK_DATA = "";
        JIBS_tmp_int = LK_DATA.length();
        for (int i=0;i<9500-JIBS_tmp_int;i++) LK_DATA += " ";
        IBS.CPY2CLS(SCCGWA, LK_DATA.substring(0, BPCRPENT.DAT_LEN), BPRENT.DATA_TXT);
        CEP.TRC(SCCGWA, BPCRPENT.DAT_LEN);
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT);
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT.CNT);
        T000_OPEN_BPTPENT();
        if (pgmRtn) return;
        T000_READNEXT_BPTPENT();
        if (pgmRtn) return;
        while (WS_BPTPENT_FLG != 'N') {
            T000_READ_BPTPENT_UPD();
            if (pgmRtn) return;
            T000_DELETE_BPTPENT();
            if (pgmRtn) return;
            T000_READNEXT_BPTPENT();
            if (pgmRtn) return;
        }
        T000_CLOSE_BPTPENT();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT.CNT);
        for (WS_CNT = 1; WS_CNT <= BPRENT.DATA_TXT.CNT; WS_CNT += 1) {
            CEP.TRC(SCCGWA, WS_CNT);
            R010_PUT_IN();
            if (pgmRtn) return;
            T000_WRITE_BPTPENT();
            if (pgmRtn) return;
        }
        CEP.TRC(SCCGWA, WS_CNT);
    }
    public void B030_DELETE_RECORD_PROC() throws IOException,SQLException,Exception {
        BPRPENT.KEY.CNT = 1;
        T000_READ_BPTPENT_UPD();
        if (pgmRtn) return;
        T000_DELETE_BPTPENT();
        if (pgmRtn) return;
    }
    public void B040_QUERY_RECORD_PROC() throws IOException,SQLException,Exception {
        T000_OPEN_BPTPENT();
        if (pgmRtn) return;
        T000_READNEXT_BPTPENT();
        if (pgmRtn) return;
        while (WS_BPTPENT_FLG != 'N') {
            R020_GET_OUT();
            if (pgmRtn) return;
            T000_READNEXT_BPTPENT();
            if (pgmRtn) return;
        }
        T000_CLOSE_BPTPENT();
        if (pgmRtn) return;
        BPRENT.DATA_TXT.CNT = BPRPENT.KEY.CNT;
        CEP.TRC(SCCGWA, BPRPENT.KEY.CNT);
        BPRENT.DATA_TXT.LSTUPD_INFO.UPD_TEL = BPRPENT.UPD_TEL;
        BPRENT.DATA_TXT.LSTUPD_INFO.UPD_DATE = BPRPENT.UPD_DATE;
        BPRENT.DATA_TXT.LSTUPD_INFO.UPD_TIME = BPRPENT.UPD_TIME;
        BPRENT.DATA_TXT.LSTUPD_INFO.SUP_TEL1 = BPRPENT.SUP_TEL1;
        BPRENT.DATA_TXT.LSTUPD_INFO.SUP_TEL2 = BPRPENT.SUP_TEL2;
        if (LK_DATA == null) LK_DATA = "";
        JIBS_tmp_int = LK_DATA.length();
        for (int i=0;i<9500-JIBS_tmp_int;i++) LK_DATA += " ";
        JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, BPRENT.DATA_TXT);
        LK_DATA = JIBS_tmp_str[0] + LK_DATA.substring(BPCRPENT.DAT_LEN);
    }
    public void R010_PUT_IN() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, WS_CNT);
        CEP.TRC(SCCGWA, BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].SORT_SEQ);
        BPRPENT.KEY.CNT = WS_CNT;
        BPRPENT.SORT_SEQ = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].SORT_SEQ;
        BPRPENT.TR_GROUP = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].TR_GROUP;
        BPRPENT.GLMST_PNT = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].GLMST_PNT;
        BPRPENT.DR_CR = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].DR_CR;
        BPRPENT.ITM_CODE = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ITM_CODE;
        BPRPENT.ITM_PNT = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ITM_PNT;
        BPRPENT.BR_FLG = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].BR_FLG;
        BPRPENT.BR = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].BR;
        BPRPENT.CCY_PNT = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].CCY_PNT;
        BPRPENT.POST_AUTH = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].POST_AUTH;
        BPRPENT.RM_FLG = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].RM_FLG;
        BPRPENT.EFF_DAYS = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].EFF_DAYS;
        BPRPENT.AMT_FLG1 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[1-1];
        BPRPENT.AMT_FLG2 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[2-1];
        BPRPENT.AMT_FLG3 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[3-1];
        BPRPENT.AMT_FLG4 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[4-1];
        BPRPENT.AMT_FLG5 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[5-1];
        BPRPENT.AMT_FLG6 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[6-1];
        BPRPENT.AMT_FLG7 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[7-1];
        BPRPENT.AMT_FLG8 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[8-1];
        BPRPENT.AMT_FLG9 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[9-1];
        BPRPENT.AMT_FLG10 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[10-1];
        BPRPENT.AMT_FLG11 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[11-1];
        BPRPENT.AMT_FLG12 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[12-1];
        BPRPENT.AMT_FLG13 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[13-1];
        BPRPENT.AMT_FLG14 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[14-1];
        BPRPENT.AMT_FLG15 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[15-1];
        BPRPENT.AMT_FLG16 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[16-1];
        BPRPENT.AMT_FLG17 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[17-1];
        BPRPENT.AMT_FLG18 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[18-1];
        BPRPENT.AMT_FLG19 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[19-1];
        BPRPENT.AMT_FLG20 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[20-1];
        BPRPENT.AMT_FLG21 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[21-1];
        BPRPENT.AMT_FLG22 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[22-1];
        BPRPENT.AMT_FLG23 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[23-1];
        BPRPENT.AMT_FLG24 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[24-1];
        BPRPENT.AMT_FLG25 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[25-1];
        BPRPENT.AMT_FLG26 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[26-1];
        BPRPENT.AMT_FLG27 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[27-1];
        BPRPENT.AMT_FLG28 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[28-1];
        BPRPENT.AMT_FLG29 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[29-1];
        BPRPENT.AMT_FLG30 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[30-1];
        BPRPENT.AMT_FLG31 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[31-1];
        BPRPENT.AMT_FLG32 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[32-1];
        BPRPENT.AMT_FLG33 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[33-1];
        BPRPENT.AMT_FLG34 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[34-1];
        BPRPENT.AMT_FLG35 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[35-1];
        BPRPENT.AMT_FLG36 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[36-1];
        BPRPENT.AMT_FLG37 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[37-1];
        BPRPENT.AMT_FLG38 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[38-1];
        BPRPENT.AMT_FLG39 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[39-1];
        BPRPENT.AMT_FLG40 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[40-1];
        BPRPENT.AMT_FLG41 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[41-1];
        BPRPENT.AMT_FLG42 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[42-1];
        BPRPENT.AMT_FLG43 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[43-1];
        BPRPENT.AMT_FLG44 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[44-1];
        BPRPENT.AMT_FLG45 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[45-1];
        BPRPENT.AMT_FLG46 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[46-1];
        BPRPENT.AMT_FLG47 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[47-1];
        BPRPENT.AMT_FLG48 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[48-1];
        BPRPENT.AMT_FLG49 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[49-1];
        BPRPENT.AMT_FLG50 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[50-1];
        BPRPENT.AMT_FLG51 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[51-1];
        BPRPENT.AMT_FLG52 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[52-1];
        BPRPENT.AMT_FLG53 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[53-1];
        BPRPENT.AMT_FLG54 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[54-1];
        BPRPENT.AMT_FLG55 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[55-1];
        BPRPENT.AMT_FLG56 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[56-1];
        BPRPENT.AMT_FLG57 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[57-1];
        BPRPENT.AMT_FLG58 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[58-1];
        BPRPENT.AMT_FLG59 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[59-1];
        BPRPENT.AMT_FLG60 = BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[60-1];
        BPRPENT.UPD_TEL = BPRENT.DATA_TXT.LSTUPD_INFO.UPD_TEL;
        BPRPENT.UPD_DATE = BPRENT.DATA_TXT.LSTUPD_INFO.UPD_DATE;
        BPRPENT.UPD_TIME = BPRENT.DATA_TXT.LSTUPD_INFO.UPD_TIME;
        BPRPENT.SUP_TEL1 = BPRENT.DATA_TXT.LSTUPD_INFO.SUP_TEL1;
        BPRPENT.SUP_TEL2 = BPRENT.DATA_TXT.LSTUPD_INFO.SUP_TEL2;
        CEP.TRC(SCCGWA, BPRPENT);
    }
    public void R020_GET_OUT() throws IOException,SQLException,Exception {
        WS_CNT = BPRPENT.KEY.CNT;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].SORT_SEQ = BPRPENT.SORT_SEQ;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].TR_GROUP = BPRPENT.TR_GROUP;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].GLMST_PNT = BPRPENT.GLMST_PNT;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].DR_CR = BPRPENT.DR_CR;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ITM_CODE = BPRPENT.ITM_CODE;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ITM_PNT = BPRPENT.ITM_PNT;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].BR_FLG = BPRPENT.BR_FLG;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].BR = BPRPENT.BR;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].CCY_PNT = BPRPENT.CCY_PNT;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].POST_AUTH = BPRPENT.POST_AUTH;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].RM_FLG = BPRPENT.RM_FLG;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].EFF_DAYS = BPRPENT.EFF_DAYS;
        BPRENT.DATA_TXT.EVENT_DATA[WS_CNT-1].ENT_REDEFINES32.AMT_FLG[1-1] = BPRPENT.AMT_FLG1;

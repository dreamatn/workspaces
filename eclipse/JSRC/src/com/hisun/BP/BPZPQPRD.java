package com.hisun.BP;

import com.hisun.SC.*;

import java.io.IOException;
import java.sql.SQLException;

public class BPZPQPRD {
    String JIBS_tmp_str[] = new String[10];
    boolean pgmRtn = false;
    String K_T_MAINT_PRDT_INFO = "BP-T-MAINT-PRDT-INFO";
    String K_T_MAINT_PRDT_MENU = "BP-T-MAINT-PRDT-MENU";
    BPCMSG_ERROR_MSG BPCMSG_ERROR_MSG = new BPCMSG_ERROR_MSG();
    BPCTPDME BPCTPDME = new BPCTPDME();
    BPCTPDCD BPCTPDCD = new BPCTPDCD();
    BPRPDME BPRPDME = new BPRPDME();
    BPRPDCD BPRPDCD = new BPRPDCD();
    SCCEXCP SCCEXCP = new SCCEXCP();
    SCCCALL SCCCALL = new SCCCALL();
    SCCMSG SCCMSG = new SCCMSG();
    SCCFMT SCCFMT = new SCCFMT();
    SCCGWA SCCGWA;
    SCCGSCA_SC_AREA GWA_SC_AREA;
    SCCGBPA_BP_AREA GWA_BP_AREA;
    BPCPQPRD BPCPQPRD;
    public void MP(SCCGWA SCCGWA, BPCPQPRD BPCPQPRD) throws IOException,SQLException,Exception {
        this.SCCGWA = SCCGWA;
        this.BPCPQPRD = BPCPQPRD;
        CEP.TRC(SCCGWA);
        A000_INIT_PROC();
        if (pgmRtn) return;
        B000_MAIN_PROC();
        if (pgmRtn) return;
        CEP.TRC(SCCGWA, "BPZPQPRD return!");
        Z_RET();
        if (pgmRtn) return;
    }
    public void A000_INIT_PROC() throws IOException,SQLException,Exception {
        GWA_BP_AREA = (SCCGBPA_BP_AREA) SCCGWA.BP_AREA_PTR;
        GWA_SC_AREA = (SCCGSCA_SC_AREA) SCCGWA.SC_AREA_PTR;
        IBS.init(SCCGWA, BPCTPDME);
        IBS.init(SCCGWA, BPCTPDCD);
        IBS.init(SCCGWA, BPCPQPRD.RC);
        BPCPQPRD.RC.RC_AP = "BP";
    }
    public void B000_MAIN_PROC() throws IOException,SQLException,Exception {
        B100_CHECK_INPUT();
        if (pgmRtn) return;
        B200_MAIN_PROC();
        if (pgmRtn) return;
        if (BPCTPDCD.RETURN_INFO == 'F' 
            || BPCTPDME.RETURN_INFO == 'F') {
            CEP.TRC(SCCGWA, "1111111");
            B300_MOVE_OUTPUT_DATA();
            if (pgmRtn) return;
        }
    }
    public void B100_CHECK_INPUT() throws IOException,SQLException,Exception {
        if (BPCPQPRD.PRDT_CODE.trim().length() == 0) {
            IBS.CPY2CLS(SCCGWA, BPCMSG_ERROR_MSG.BP_PRD_CODE_MUST_INPUT, BPCPQPRD.RC);
            Z_RET();
            if (pgmRtn) return;
        }
    }
    public void B200_MAIN_PROC() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, BPCPQPRD.PRDT_CODE);
        IBS.init(SCCGWA, BPCTPDME);
        IBS.init(SCCGWA, BPRPDME);
        BPCTPDME.INFO.FUNC = 'I';
        BPRPDME.KEY.PRDT_CODE = BPCPQPRD.PRDT_CODE;
        S000_CALL_BPZTPDME();
        if (pgmRtn) return;
        IBS.init(SCCGWA, BPCTPDCD);
        IBS.init(SCCGWA, BPRPDCD);
        BPCTPDCD.INFO.FUNC = 'I';
        BPRPDCD.KEY.PRDT_CODE = BPCPQPRD.PRDT_CODE;
        CEP.TRC(SCCGWA, BPRPDCD.KEY.PRDT_CODE);
        S000_CALL_BPZTPDCD();
        if (pgmRtn) return;
        R000_CHECK_RETURN_1();
        if (pgmRtn) return;
    }
    public void B300_MOVE_OUTPUT_DATA() throws IOException,SQLException,Exception {
        IBS.init(SCCGWA, BPCPQPRD);
        BPCPQPRD.CUS_PER_FLG = BPRPDCD.CUS_PER_FLG;
        CEP.TRC(SCCGWA, BPRPDCD.CUS_PER_FLG);
        BPCPQPRD.CUS_COM_FLG = BPRPDCD.CUS_COM_FLG;
        CEP.TRC(SCCGWA, BPRPDCD.CUS_COM_FLG);
        BPCPQPRD.CUS_FIN_FLG = BPRPDCD.CUS_FIN_FLG;
        CEP.TRC(SCCGWA, BPRPDCD.CUS_FIN_FLG);
        BPCPQPRD.CUS_COM_SCOPE = BPRPDCD.CUS_COM_SCOPE;
        BPCPQPRD.CUS_COM_TYP1 = BPRPDCD.CUS_COM_TYP1;
        BPCPQPRD.CUS_COM_TYP2 = BPRPDCD.CUS_COM_TYP2;
        BPCPQPRD.CUS_COM_TYP3 = BPRPDCD.CUS_COM_TYP3;
        BPCPQPRD.CUS_COM_TYP4 = BPRPDCD.CUS_COM_TYP4;
        BPCPQPRD.CUS_COM_TYP5 = BPRPDCD.CUS_COM_TYP5;
        BPCPQPRD.CUS_COM_TYP6 = BPRPDCD.CUS_COM_TYP6;
        BPCPQPRD.CUS_COM_TYP7 = BPRPDCD.CUS_COM_TYP7;
        BPCPQPRD.CUS_COM_TYP8 = BPRPDCD.CUS_COM_TYP8;
        BPCPQPRD.CUS_COM_TYP9 = BPRPDCD.CUS_COM_TYP9;
        BPCPQPRD.CUS_COM_TYP10 = BPRPDCD.CUS_COM_TYP10;
        BPCPQPRD.CUS_FIN_SCOPE = BPRPDCD.CUS_FIN_SCOPE;
        BPCPQPRD.CUS_FIN_TYP1 = BPRPDCD.CUS_FIN_TYP1;
        BPCPQPRD.CUS_FIN_TYP2 = BPRPDCD.CUS_FIN_TYP2;
        BPCPQPRD.CUS_FIN_TYP3 = BPRPDCD.CUS_FIN_TYP3;
        BPCPQPRD.CUS_FIN_TYP4 = BPRPDCD.CUS_FIN_TYP4;
        BPCPQPRD.CUS_FIN_TYP5 = BPRPDCD.CUS_FIN_TYP5;
        BPCPQPRD.CUS_FIN_TYP6 = BPRPDCD.CUS_FIN_TYP6;
        BPCPQPRD.CUS_FIN_TYP7 = BPRPDCD.CUS_FIN_TYP7;
        BPCPQPRD.CUS_FIN_TYP8 = BPRPDCD.CUS_FIN_TYP8;
        BPCPQPRD.CUS_FIN_TYP9 = BPRPDCD.CUS_FIN_TYP9;
        BPCPQPRD.CUS_FIN_TYP10 = BPRPDCD.CUS_FIN_TYP10;
        BPCPQPRD.CUS_GROUP_SCOPE = BPRPDCD.CUS_GROUP_SCOPE;
        BPCPQPRD.CUS_GROUP1 = BPRPDCD.CUS_GROUP1;
        BPCPQPRD.CUS_GROUP2 = BPRPDCD.CUS_GROUP2;
        BPCPQPRD.CUS_GROUP3 = BPRPDCD.CUS_GROUP3;
        BPCPQPRD.CUS_GROUP4 = BPRPDCD.CUS_GROUP4;
        BPCPQPRD.CUS_GROUP5 = BPRPDCD.CUS_GROUP5;
        BPCPQPRD.CUS_GROUP6 = BPRPDCD.CUS_GROUP6;
        BPCPQPRD.CUS_GROUP7 = BPRPDCD.CUS_GROUP7;
        BPCPQPRD.CUS_GROUP8 = BPRPDCD.CUS_GROUP8;
        BPCPQPRD.CUS_GROUP9 = BPRPDCD.CUS_GROUP9;
        BPCPQPRD.CUS_GROUP10 = BPRPDCD.CUS_GROUP10;
        BPCPQPRD.PARTI_METH = BPRPDCD.PARTI_METH;
        CEP.TRC(SCCGWA, BPRPDCD.PARTI_METH);
        BPCPQPRD.PARTI_TYPE = BPRPDCD.PARTI_TYPE;
        BPCPQPRD.PARTI_STRU = BPRPDCD.PARTI_STRU;
        BPCPQPRD.SOLD_RGN = BPRPDCD.SOLD_RGN;
        BPCPQPRD.CHNL_SCOPE = BPRPDCD.CHNL_SCOPE;
        BPCPQPRD.CHNL1 = BPRPDCD.CHNL1;
        BPCPQPRD.CHNL2 = BPRPDCD.CHNL2;
        BPCPQPRD.CHNL3 = BPRPDCD.CHNL3;
        BPCPQPRD.CHNL4 = BPRPDCD.CHNL4;
        BPCPQPRD.CHNL5 = BPRPDCD.CHNL5;
        BPCPQPRD.CHNL6 = BPRPDCD.CHNL6;
        BPCPQPRD.CHNL7 = BPRPDCD.CHNL7;
        BPCPQPRD.CHNL8 = BPRPDCD.CHNL8;
        BPCPQPRD.CHNL9 = BPRPDCD.CHNL9;
        BPCPQPRD.CHNL10 = BPRPDCD.CHNL10;
        BPCPQPRD.PRDT_CUST_INFO = BPRPDCD.PRDT_CUST_INFO;
        BPCPQPRD.PRDT_MARKT_GOAL = BPRPDCD.PRDT_MARKT_GOAL;
        BPCPQPRD.COMP_PRDT_DESC = BPRPDCD.COMP_PRDT_DESC;
        BPCPQPRD.PRDT_ADV_DESC = BPRPDCD.PRDT_ADV_DESC;
        BPCPQPRD.PRDT_FAV_INFO = BPRPDCD.PRDT_FAV_INFO;
        CEP.TRC(SCCGWA, "2222222");
        CEP.TRC(SCCGWA, BPRPDCD.PRDT_COUNTER);
        CEP.TRC(SCCGWA, BPCPQPRD.PRDT_COUNTER);
        BPCPQPRD.PRDT_COUNTER = BPRPDCD.PRDT_COUNTER;
        BPCPQPRD.SOLD_NUM = BPRPDCD.SOLD_NUM;
        BPCPQPRD.SOLD_AMT = BPRPDCD.SOLD_AMT;
        CEP.TRC(SCCGWA, "3333333");
        BPCPQPRD.PRDT_NAME = BPRPDME.PRDT_NAME;
        BPCPQPRD.BUSI_TYPE = BPRPDME.BUSI_TYPE;
        BPCPQPRD.CTRACT_GROUP = BPRPDME.CTRACT_GROUP;
        BPCPQPRD.PRDT_MODEL = BPRPDME.PRDT_MODEL;
        BPCPQPRD.PRDT_MODEL1 = BPRPDME.PRDT_MODEL1;
        BPCPQPRD.PRDT_MODEL2 = BPRPDME.PRDT_MODEL2;
        BPCPQPRD.PRDT_MODEL3 = BPRPDME.PRDT_MODEL3;
        BPCPQPRD.PRDT_MODEL4 = BPRPDME.PRDT_MODEL4;
        BPCPQPRD.PRDT_MODEL5 = BPRPDME.PRDT_MODEL5;
        BPCPQPRD.PRDT_IND = BPRPDME.PRDT_IND;
        BPCPQPRD.DESC = BPRPDME.DESC;
        BPCPQPRD.EFF_DATE = BPRPDME.EFF_DATE;
        if (BPRPDME.EFF_DATE > SCCGWA.COMM_AREA.AC_DATE) {
            IBS.CPY2CLS(SCCGWA, BPCMSG_ERROR_MSG.BP_PRDT_CANNOT_SALE, BPCPQPRD.RC);
        }
        BPCPQPRD.EXP_DATE = BPRPDME.EXP_DATE;
        CEP.TRC(SCCGWA, BPCPQPRD.STOP_SOLD_DATE);
        BPCPQPRD.STOP_SOLD_DATE = BPRPDME.STOP_SOLD_DATE;
        BPCPQPRD.PARM_CODE = BPRPDME.PARM_CODE;
        CEP.TRC(SCCGWA, BPCPQPRD.PARM_CODE);
        BPCPQPRD.AC_TYPE = BPRPDME.AC_RULE;
        CEP.TRC(SCCGWA, BPCPQPRD.AC_TYPE);
        BPCPQPRD.PRDT_MANEGER = BPRPDME.PRDT_MANEGER;
        BPCPQPRD.ASS_BR = BPRPDME.ASS_BR;
    }
    public void R000_CHECK_RETURN_1() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, BPCTPDME.RETURN_INFO);
        CEP.TRC(SCCGWA, BPCTPDCD.RETURN_INFO);
        if (BPCTPDCD.RETURN_INFO == 'N' 
            || BPCTPDME.RETURN_INFO == 'N') {
            IBS.CPY2CLS(SCCGWA, BPCMSG_ERROR_MSG.BP_QPRD_RECORD_NO_EXIST, BPCPQPRD.RC);
            Z_RET();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_BPZTPDME() throws IOException,SQLException,Exception {
        BPCTPDME.INFO.POINTER = BPRPDME;
        BPCTPDME.LEN = 516;
        IBS.CALLCPN(SCCGWA, K_T_MAINT_PRDT_MENU, BPCTPDME);
        CEP.TRC(SCCGWA, BPCTPDME.RC);
        if (BPCTPDME.RC.RC_CODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, BPCTPDME.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], BPCPQPRD.RC);
            Z_RET();
            if (pgmRtn) return;
        }
    }
    public void S000_CALL_BPZTPDCD() throws IOException,SQLException,Exception {
        BPCTPDCD.INFO.POINTER = BPRPDCD;
        BPCTPDCD.LEN = 430;
        IBS.CALLCPN(SCCGWA, K_T_MAINT_PRDT_INFO, BPCTPDCD);
        if (BPCTPDCD.RC.RC_CODE != 0) {
            JIBS_tmp_str[0] = IBS.CLS2CPY(SCCGWA, BPCTPDCD.RC);
            IBS.CPY2CLS(SCCGWA, JIBS_tmp_str[0], BPCPQPRD.RC);
            Z_RET();
            if (pgmRtn) return;
        }
    }
    public void Z_RET() throws IOException,SQLException,Exception {
        CEP.TRC(SCCGWA, BPCPQPRD.RC);
    if (SCCGWA.COMM_AREA.BSP_FLG.equalsIgnoreCase("BSP") || SCCGWA.COMM_AREA.CHNL.equalsIgnoreCase("BAT")) { //FROM #IFDEF BAT
        if (BPCPQPRD.RC.RC_CODE != 0) {
            CEP.TRC(SCCGWA, " BPCPQPRD = ");
            CEP.TRC(SCCGWA, BPCPQPRD);
        }
    } //FROM #ENDIF
        pgmRtn = true;
        return;
    }
    public void B_DB_EXCP() throws IOException,SQLException,Exception {
        throw new SQLException(SCCGWA.e);
    }
}
